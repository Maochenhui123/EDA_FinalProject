<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Interactive component | Hidden Fact of Food Market</title>
  <meta name="description" content="Chapter 6 Interactive component | Hidden Fact of Food Market" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Interactive component | Hidden Fact of Food Market" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Interactive component | Hidden Fact of Food Market" />
  
  
  

<meta name="author" content="Chenhui Mao, Yena Lee, Ellen Chen" />


<meta name="date" content="2021-04-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="results.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hidden Fact of Food Market</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a><ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#about-the-dataset"><i class="fa fa-check"></i><b>2.2</b> About the Dataset</a></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#observation"><i class="fa fa-check"></i><b>2.3</b> Observation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a><ul>
<li class="chapter" data-level="4.1" data-path="missing-values.html"><a href="missing-values.html#graph-i."><i class="fa fa-check"></i><b>4.1</b> Graph I.</a></li>
<li class="chapter" data-level="4.2" data-path="missing-values.html"><a href="missing-values.html#graph-ii."><i class="fa fa-check"></i><b>4.2</b> Graph II.</a></li>
<li class="chapter" data-level="4.3" data-path="missing-values.html"><a href="missing-values.html#feature-engineering"><i class="fa fa-check"></i><b>4.3</b> Feature Engineering</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a><ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#how-vitamins-on-food-markets-vary-by-country"><i class="fa fa-check"></i><b>5.1</b> How Vitamins on Food Markets Vary by Country?</a><ul>
<li class="chapter" data-level="5.1.1" data-path="results.html"><a href="results.html#energy-in-food-among-different-countries"><i class="fa fa-check"></i><b>5.1.1</b> Energy in food among different countries</a></li>
<li class="chapter" data-level="5.1.2" data-path="results.html"><a href="results.html#vitamins-among-different-countries"><i class="fa fa-check"></i><b>5.1.2</b> Vitamins among Different countries</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#which-country-eat-the-most-sugar"><i class="fa fa-check"></i><b>5.2</b> Which country eat the most sugar?</a></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#which-country-has-the-highest-diabetes-prevalence"><i class="fa fa-check"></i><b>5.3</b> Which country has the highest diabetes prevalence?</a></li>
<li class="chapter" data-level="5.4" data-path="results.html"><a href="results.html#what-are-the-most-frequent-keywords-in-a-keto-friendly-product-in-the-us-and-france-supermarkets"><i class="fa fa-check"></i><b>5.4</b> What are the most frequent keywords in a Keto-friendly product in the US and France supermarkets?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a><ul>
<li class="chapter" data-level="7.1" data-path="conclusion.html"><a href="conclusion.html#limitations"><i class="fa fa-check"></i><b>7.1</b> Limitations</a></li>
<li class="chapter" data-level="7.2" data-path="conclusion.html"><a href="conclusion.html#future-directions"><i class="fa fa-check"></i><b>7.2</b> Future Directions</a></li>
<li class="chapter" data-level="7.3" data-path="conclusion.html"><a href="conclusion.html#lessons-learned"><i class="fa fa-check"></i><b>7.3</b> Lessons Learned</a><ul>
<li class="chapter" data-level="7.3.1" data-path="conclusion.html"><a href="conclusion.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>7.3.1</b> Exploratory Data Analysis</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hidden Fact of Food Market</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactive-component" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Interactive component</h1>
<div id="chart" style="width: 700px; float:left;">

</div>
<div id="text" style="width: 400px; float: left;">

</div>
<script src="https://d3js.org/d3.v6.js"></script>
<script>

      var chart = d3.select("div#chart")
      chart.style("width: 700px; float:left;")
      chart.append("h3").text("Proportion of Vitamins among different countries")
      chart.append("p").text("In this graph you can choose to see the proportion of different vitamins among different countries by simply selecting the countries at the bottom. Also you can see the details of the proportion down there, the number will change as you select different countries.")
      var text = d3.select("div#text")
      text.style("width: 400px; float: left;")
      text.append("h3").text("Countries: ")
            .append("span").attr("id","countries_en")
      text.append("p").text("Vitamin A: ")
            .append("span").attr("id","vitamin_a")
      text.append("p").text("Vitamin B1: ")
            .append("span").attr("id","vitamin_b1")
      text.append("p").text("Vitamin B2: ")
            .append("span").attr("id","vitamin_b2")
      text.append("p").text("Vitamin C: ")
            .append("span").attr("id","vitamin_c")
      text.append("p").text("Vitamin D: ")
            .append("span").attr("id","vitamin_d")
      text.append("p").text("Vitamin E: ")
            .append("span").attr("id","vitamin_e")
      function update_text(data,countries_en){
        d3.select("#countries_en").text(countries_en)
        var vitamin_a = (Number(data[0])*100).toFixed(2)
        var vitamin_b1 = (Number(data[1])*100).toFixed(2)
        var vitamin_b2 = (Number(data[2])*100).toFixed(2)
        var vitamin_c = (Number(data[3])*100).toFixed(2)
        var vitamin_d = (Number(data[4])*100).toFixed(2)
        var vitamin_e = (Number(data[5])*100).toFixed(2)
        d3.select("#vitamin_a").text(vitamin_a+"%")
        d3.select("#vitamin_b1").text(vitamin_b1+"%")
        d3.select("#vitamin_b2").text(vitamin_b2+"%")
        d3.select("#vitamin_c").text(vitamin_c+"%")
        d3.select("#vitamin_d").text(vitamin_d+"%")
        d3.select("#vitamin_e").text(vitamin_e+"%")
      }
      function update(data,country) {
        update_text(data,country)
        var bars = svg.selectAll("rect")   // data join
                      .data(data);
        xScale = d3.scaleBand()
                    .domain(d3.range(data.length))
                    .range([0, innerWidth])
                    .paddingInner(.2);

        yScale = d3.scaleLinear()
                    .domain([0, 1])
                    .range([innerHeight, 0])
        
        bars.enter()
            .append("rect")    // add new elements
            .attr("x", (d, i) => xScale(i))
            .attr("y", (d, i)=> yScale(d))
            .attr("width", xScale.bandwidth())
            .attr("height", d => innerHeight - yScale(d))
            .attr("fill", "lightgreen")
          .merge(bars)    // merge
            .transition()
            .duration(2000)
            .attr("x", (d, i) => xScale(i))
            .attr("y", (d, i)=> yScale(d))
            .attr("width", xScale.bandwidth())
            .attr("height", d => innerHeight - yScale(d))
            .attr("fill", "lightgreen");

    bars.exit().remove();    // remove extra elements
    }
      var w = 600;
      var h = 500;
      var margin = {top: 30, right: 30, bottom: 30, left: 30};
      var innerWidth = w - margin.left - margin.right;
      var innerHeight = h - margin.top - margin.bottom;

      var svg = d3.select("div#chart")
        .append("svg")
          .attr("width", w)
          .attr("height", h);

      d3.csv("https://raw.githubusercontent.com/Maochenhui123/Data/main/d3/vitamins_countries.csv")
        .then(
              function(data){
                console.log(data)
                var countries = {};
                var bardata = [];
                let len = data.length
                let init_country = data[0].countries_en
                for(var i=0; i<data.length;i++){
                  let countries_en = data[i].countries_en
                  if(data[i].countries_en in countries){
                    countries[countries_en].push(Number(data[i].proportion).toFixed(5))
                  }else{
                    countries[countries_en] = [Number(data[i].proportion).toFixed(5)]
                  }
                }
                
                bardata = countries[init_country]
                update_text(bardata,init_country)
                var xScale = d3.scaleBand()
                              .domain(d3.range(bardata.length))
                              .range([0, innerWidth])
                              .paddingInner(.2);

                var vitamins = d3.scaleBand()
                                  .range([0, innerWidth])
                                  .domain(["vitamins.a","vitamins.b1","vitamins.b2","vitamins.c","vitamins.d","vitamins.e"])
                var yScale = d3.scaleLinear()
                                .domain([0, 1])
                                .range([innerHeight, 0])

                var xAxis = d3.axisBottom()
                      .scale(vitamins);
                      
                var yAxis = d3.axisLeft()
                      .scale(yScale);
                svg.append("g")
                    .attr("class", "xAxis")
                    .attr("transform", `translate (${margin.left}, ${h - margin.bottom})`)
                    .call(xAxis);

                svg.append("g")
                    .attr("class", "yAxis")
                    .attr("transform", `translate (${margin.left}, ${margin.top})`)
                    .call(yAxis);
                var bars = svg.append("g")
                              .attr("id", "plot")
                              .attr("transform", `translate (${margin.left}, ${margin.top})`)
                              .selectAll("rect")
                              .data(bardata);

                bars.enter().append("rect")
                    .attr("x", (d, i) => xScale(i))
                    .attr("y", (d, i)=> yScale(d))
                    .attr("width", xScale.bandwidth())
                    .attr("height", d => innerHeight - yScale(d))
                    .attr("fill", "lightgreen")
                    .append("title")
                    .text(function(d){
                      return d;
                    });
                    var countries_en = Object.keys(countries)
                    var selector = d3.select("div#chart")
                       .append("div").attr("id","interactive")
                       .append("select").attr("id","bar")
                       .on("change",function(d){
                          var selection = document.getElementById("bar");
                          var country = selection.value;
                          var data = countries[country]
                          update(data,country)
                          d3.selectAll("rect")
                            .select("title")
                            .text(function(d){
                          return d;
                        });
                      })
      
                    selector.selectAll("option")
                       .data(countries_en)
                       .enter().append("option")
                       .attr("value", d=>d)
                       .text(d=>d)
                    }
                  );

      
</script>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Maochenhui123/EDA_FinalProject/edit/main/06-interactive.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Maochenhui123/EDA_FinalProject/blob/main/06-interactive.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
